(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[6],{

/***/ "./src/public/js/pages/singleTicket.js":
/*!*********************************************!*\
  !*** ./src/public/js/pages/singleTicket.js ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*\n *       .                             .o8                     oooo\n *    .o8                             \"888                     `888\n *  .o888oo oooo d8b oooo  oooo   .oooo888   .ooooo.   .oooo.o  888  oooo\n *    888   `888\"\"8P `888  `888  d88' `888  d88' `88b d88(  \"8  888 .8P'\n *    888    888      888   888  888   888  888ooo888 `\"Y88b.   888888.\n *    888 .  888      888   888  888   888  888    .o o.  )88b  888 `88b.\n *    \"888\" d888b     `V88V\"V8P' `Y8bod88P\" `Y8bod8P' 8\"\"888P' o888o o888o\n *  ========================================================================\n *  Author:     Chris Brame\n *  Updated:    1/20/19 4:46 PM\n *  Copyright (c) 2014-2019. All rights reserved.\n */\n\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [\n  __webpack_require__(/*! jquery */ \"./src/public/js/vendor/jquery/jquery.js\"),\n  __webpack_require__(/*! underscore */ \"./src/public/js/vendor/underscore/underscore.js\"),\n  __webpack_require__(/*! modules/socket */ \"./src/public/js/modules/socket.js\"),\n  __webpack_require__(/*! tomarkdown */ \"./src/public/js/vendor/tomarkdown/tomarkdown.js\"),\n  __webpack_require__(/*! modules/helpers */ \"./src/public/js/modules/helpers.js\"),\n  __webpack_require__(/*! jquery_custom */ \"./src/public/js/plugins/jquery.custom.js\")\n], __WEBPACK_AMD_DEFINE_RESULT__ = (function ($, _, socketClient, md, helpers) {\n  var st = {}\n  st.init = function (callback) {\n    $(document).ready(function () {\n      socketClient.chat.updateOnlineBubbles()\n\n      helpers.setupTruTabs($('.tru-tab-selectors').find('.tru-tab-selector'))\n\n      $('.off-canvas-bottom').DivResizer({})\n\n      $('.issue-body img:not(.hasLinked)').each(function () {\n        setupImageLink(this)\n      })\n\n      $('.comment-body img:not(.hasLinked)').each(function () {\n        setupImageLink(this)\n      })\n\n      function setupImageLink (el) {\n        var $this = $(el)\n        var src = $this.attr('src')\n        $this.addClass('hasLinked')\n        var a = $('<a>')\n          .addClass('no-ajaxy')\n          .attr('href', src)\n          .attr('target', '_blank')\n        $this.wrap(a)\n      }\n\n      $('.remove-attachment').each(function () {\n        var self = $(this)\n        self.off('click', onRemoveAttachmentClick)\n        self.on('click', onRemoveAttachmentClick)\n      })\n      $('.remove-comment').each(function () {\n        var self = $(this)\n        self.off('click', onRemoveCommentClick)\n        self.on('click', onRemoveCommentClick)\n      })\n      // $('.edit-comment').each(function () {\n      //   var self = $(this)\n      //   self.off('click', onEditCommentClick)\n      //   self.on('click', onEditCommentClick)\n      // })\n      $('.remove-note').each(function () {\n        var self = $(this)\n        self.off('click', onRemoveNoteClick)\n        self.on('click', onRemoveNoteClick)\n      })\n      // $('.edit-note').each(function () {\n      //   var self = $(this)\n      //   self.off('click', onEditNoteClick)\n      //   self.on('click', onEditNoteClick)\n      // })\n      // $('.edit-issue').each(function () {\n      //   var self = $(this)\n      //   self.off('click', onEditIssueClick)\n      //   self.on('click', onEditIssueClick)\n      // })\n\n      // Setup Text\n      var issueText = $('.issue-text')\n        .find('div.issue-body')\n        .html()\n      if (!_.isUndefined(issueText)) {\n        issueText = md(issueText)\n        issueText = issueText.trim()\n        $('#issueText').val(issueText)\n      }\n\n      // Set Comment Editing\n      var editCommentForm = $('div.edit-comment-form')\n      editCommentForm.find('form').each(function (idx, f) {\n        var form = $(f)\n        form.unbind('submit')\n        form.submit(function ($event) {\n          $event.preventDefault()\n          if (!form.isValid(null, null, false)) return true\n          var id = $('#__ticketId').html()\n          if (id.length > 0) {\n            var comment = $($event.currentTarget)\n              .find('textarea#commentText')\n              .val()\n            var commentId = $($event.currentTarget).attr('data-commentId')\n\n            socketClient.ui.setCommentText(id, commentId, comment)\n          }\n        })\n      })\n\n      editCommentForm.find('.resetForm').each(function (idx, item) {\n        var button = $(item)\n        button.off('click')\n        button.on('click', function ($event) {\n          $event.preventDefault()\n\n          var grandParent = button.parents('div.edit-comment-form')\n          var comment = button.parents('div.ticket-comment').find('.comment-body')\n\n          if (grandParent.length > 0) {\n            grandParent.addClass('hide')\n            comment.removeClass('hide')\n          }\n        })\n      })\n\n      // Setup Internal Note Editing\n      var editNoteForm = $('div.edit-note-form')\n      editNoteForm.find('form').each(function (idx, f) {\n        var form = $(f)\n        form.off('submit')\n        form.on('submit', function ($event) {\n          $event.preventDefault()\n          if (!form.isValid(null, null, false)) return true\n          var id = $('#__ticketId').text()\n          if (id.length > 0) {\n            var note = $($event.currentTarget)\n              .find('textarea#noteText')\n              .val()\n            var noteId = $($event.currentTarget).attr('data-noteId')\n\n            socketClient.ui.setNoteText(id, noteId, note)\n          }\n        })\n      })\n\n      editNoteForm.find('.resetForm').each(function (idx, item) {\n        var button = $(item)\n        button.off('click')\n        button.on('click', function ($event) {\n          $event.preventDefault()\n\n          var grandParent = button.parents('div.edit-note-form')\n          var note = button.parents('div.ticket-note').find('.comment-body')\n\n          if (grandParent.length > 0) {\n            grandParent.addClass('hide')\n            note.removeClass('hide')\n          }\n        })\n      })\n\n      if (typeof callback === 'function') {\n        return callback()\n      }\n    })\n  }\n\n  function onRemoveAttachmentClick (e) {\n    var self = $(e.currentTarget)\n    if (_.isUndefined(self)) {\n      return true\n    }\n\n    var ticketId = $('#__ticketId').html()\n    var attachmentId = self.attr('data-attachmentId')\n    if (attachmentId.length > 0 && ticketId.length > 0) {\n      $.ajax({\n        url: '/api/v1/tickets/' + ticketId + '/attachments/remove/' + attachmentId,\n        type: 'DELETE',\n        success: function () {\n          socketClient.ui.refreshTicketAttachments(ticketId)\n        },\n        error: function (err) {\n          var res = err.responseJSON\n          console.log('[trudesk:singleTicket:onRemoveAttachmentClick] - ' + res.error)\n          // helpers.showFlash(res.error, true);\n          helpers.UI.showSnackbar(res.err, true)\n        }\n      })\n    }\n  }\n\n  function onRemoveCommentClick (e) {\n    var self = $(e.currentTarget)\n    if (_.isUndefined(self)) {\n      return true\n    }\n\n    var ticketId = $('#__ticketId').html()\n    var commentId = self.attr('data-commentId')\n    if (commentId.length > 0 && ticketId.length > 0) {\n      socketClient.ui.removeComment(ticketId, commentId)\n    }\n  }\n\n  function onRemoveNoteClick (e) {\n    var self = $(e.currentTarget)\n    if (_.isUndefined(self)) {\n      return true\n    }\n\n    var ticketId = $('#__ticketId').html()\n    var noteId = self.attr('data-noteid')\n    if (noteId.length > 0 && ticketId.length > 0) {\n      socketClient.ui.removeNote(ticketId, noteId)\n    }\n  }\n\n  return st\n}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))\n\n\n//# sourceURL=webpack:///./src/public/js/pages/singleTicket.js?");

/***/ })

}]);